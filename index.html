<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Eternal Hunt Game</title>
  <style>
    body {
      font-family: 'Trebuchet MS', sans-serif;
      background: #111;
      color: #eee;
      text-align: center;
      margin: 0;
      padding: 0;
    }
    h1 { color: #ff4444; text-shadow: 0 0 10px #f00; animation: fadePulse 3s infinite alternate; }
    .tab-buttons button {
      margin: 5px;
      padding: 10px 15px;
      border-radius: 8px;
      border: none;
      background: #333;
      color: #eee;
      cursor: pointer;
      transition: transform 0.2s, background 0.3s;
    }
    .tab-buttons button:hover { transform: scale(1.05); background:#444; }
    .tab-buttons button.active { background: #ff4444; box-shadow: 0 0 10px #f00; }
    .tab { display: none; padding: 20px; animation: fadeIn 0.5s; }
    .tab.active { display: block; }
    .quest.completed { text-decoration: line-through; color: #aaa; }
    .event-active { color: #ff4444; font-weight: bold; animation: glow 1s infinite alternate; }

    /* Animations */
    @keyframes glow {
      from { text-shadow: 0 0 5px #f00; }
      to { text-shadow: 0 0 20px #f00; }
    }
    @keyframes fadeIn {
      from {opacity:0; transform:translateY(10px);}
      to {opacity:1; transform:translateY(0);}
    }
    @keyframes fadePulse {
      from {opacity:0.8;}
      to {opacity:1;}
    }
    @keyframes flashGreen {
      from {background:#0f0; color:#000;}
      to {background:inherit; color:inherit;}
    }
    @keyframes flashRed {
      from {background:#f00; color:#000;}
      to {background:inherit; color:inherit;}
    }
    @keyframes flashGray {
      from {background:#777; color:#000;}
      to {background:inherit; color:inherit;}
    }
    @keyframes shake {
      0% { transform: translate(0, 0); }
      25% { transform: translate(-5px, 0); }
      50% { transform: translate(5px, 0); }
      75% { transform: translate(-5px, 0); }
      100% { transform: translate(0, 0); }
    }
    .flash-green { animation: flashGreen 0.6s; }
    .flash-red { animation: flashRed 0.6s; }
    .flash-gray { animation: flashGray 0.6s; }
    .shake { animation: shake 0.5s; }
  </style>
</head>
<body>
  <h1>üê∫ Eternal Hunt</h1>
  <div class="tab-buttons">
    <button onclick="openTab('hunt')" class="active">Hunt</button>
    <button onclick="openTab('train')">Train</button>
    <button onclick="openTab('pvp')">PvP</button>
    <button onclick="openTab('inventory')">Inventory</button>
    <button onclick="openTab('shop')">Shop</button>
    <button onclick="openTab('quests')">Quests</button>
    <button onclick="openTab('codex')">Codex</button>
    <button onclick="openTab('leaderboard')">Leaderboard</button>
  </div>

  <!-- Tabs -->
  <div id="hunt" class="tab active">
    <h2>Hunt</h2>
    <button onclick="hunt()" id="huntBtn">Hunt Prey</button>
    <p id="huntResult"></p>
    <p id="bloodMoon"></p>
  </div>
  <div id="train" class="tab">
    <h2>Train</h2>
    <button onclick="train()" id="trainBtn">Train (+Strength)</button>
    <p id="trainResult"></p>
  </div>
  <div id="pvp" class="tab">
    <h2>PvP Arena</h2>
    <button onclick="pvp()" id="pvpBtn">Quick Match</button>
    <div id="pvpResult"></div>
  </div>
  <div id="inventory" class="tab">
    <h2>Inventory</h2>
    <ul id="inventoryList"></ul>
  </div>
  <div id="shop" class="tab">
    <h2>Relic Shop</h2>
    <button onclick="buyItem('Moonfang Dagger',50)">Moonfang Dagger (50 $PREY)</button>
    <button onclick="buyItem('Relic of the Ancients',150)">Relic of the Ancients (150 $PREY)</button>
    <button onclick="buyItem('Totem of the Alpha',300)">Totem of the Alpha (300 $PREY)</button>
    <p id="shopResult"></p>
  </div>
  <div id="quests" class="tab">
    <h2>Quests</h2>
    <ul id="questList"></ul>
  </div>
  <div id="codex" class="tab">
    <h2>Lore Codex</h2>
    <div id="codexEntries"></div>
  </div>
  <div id="leaderboard" class="tab">
    <h2>Leaderboard</h2>
    <ol id="leaderboardList"></ol>
  </div>

  <!-- Sound effects -->
  <audio id="sfxHunt" src="https://actions.google.com/sounds/v1/animals/wolf_howl.ogg"></audio>
  <audio id="sfxTrain" src="https://actions.google.com/sounds/v1/impacts/metal_clang.ogg"></audio>
  <audio id="sfxWin" src="https://actions.google.com/sounds/v1/cartoon/clang_and_wobble.ogg"></audio>
  <audio id="sfxLose" src="https://actions.google.com/sounds/v1/cartoon/cartoon_boing.ogg"></audio>
  <audio id="sfxBloodMoon" src="https://actions.google.com/sounds/v1/alarms/bell_ringing.ogg"></audio>

  <script>
    let prey = 0, strength = 1, level = 1, xp = 0;
    let inventory = JSON.parse(localStorage.getItem('inventory')||'[]');
    let leaderboard = JSON.parse(localStorage.getItem('leaderboard')||'[]');
    let quests = [
      {id:1, text:"Hunt 3 times", goal:3, progress:0, reward:50, completed:false},
      {id:2, text:"Win 2 PvP battles", goal:2, progress:0, reward:"Relic of the Ancients", completed:false}
    ];
    let codex = [
      {level:1, text:"The Wolves are bound by the Eternal Hunt, a curse and a gift passed down from the First Moon."},
      {level:5, text:"Hunters forged pacts of steel and blood, rising to defy the dominion of the Wolves."},
      {level:10, text:"When the Blood Moon ascends, ancient relics awaken, granting untold power to those who dare claim them."},
      {level:20, text:"Legends speak of the Alpha Eternal, a spirit wolf whose howl can shatter worlds."}
    ];
    let huntsToday = 0, pvpWins = 0;

    function playSound(id){
      const sound = document.getElementById(id);
      sound.currentTime = 0;
      sound.play().catch(()=>{}); // avoid autoplay block errors
    }

    function save(){
      localStorage.setItem('inventory', JSON.stringify(inventory));
      localStorage.setItem('leaderboard', JSON.stringify(leaderboard));
    }

    function openTab(tab){
      document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
      document.getElementById(tab).classList.add('active');
      document.querySelectorAll('.tab-buttons button').forEach(b=>b.classList.remove('active'));
      document.querySelector(`.tab-buttons button[onclick="openTab('${tab}')"]`).classList.add('active');
      if(tab==='quests') renderQuests();
      if(tab==='inventory') renderInventory();
      if(tab==='codex') renderCodex();
      if(tab==='leaderboard') renderLeaderboard();
    }

    function isBloodMoon(){
      const now = Date.now();
      return Math.floor(now/60000)%4===0;
    }

    function hunt(){
      let gained = Math.floor(Math.random()*10)+1;
      let resultElem = document.getElementById('huntResult');
      let btn = document.getElementById('huntBtn');
      if(isBloodMoon()){ 
        gained *= 2; 
        document.getElementById('bloodMoon').textContent = "üåë Blood Moon active! Double rewards."; 
        playSound('sfxBloodMoon');
      }
      else { document.getElementById('bloodMoon').textContent = ""; }
      prey += gained;
      xp += 10;
      huntsToday++;
      checkLevelUp();
      resultElem.textContent = `You hunted and gained ${gained} $PREY. Total: ${prey}`;
      btn.classList.remove('flash-green','flash-gray');
      btn.offsetWidth; 
      btn.classList.add(gained>5 ? 'flash-green':'flash-gray');
      playSound('sfxHunt');
      updateQuests('hunt');
      save();
    }

    function train(){
      let btn = document.getElementById('trainBtn');
      if(prey>=20){ prey -=20; strength++; xp+=5; checkLevelUp();
        document.getElementById('trainResult').textContent = `You trained. Strength=${strength}`;
        btn.classList.remove('flash-green'); btn.offsetWidth; btn.classList.add('flash-green');
        playSound('sfxTrain');
      } else {
        document.getElementById('trainResult').textContent = "Not enough $PREY to train.";
        btn.classList.remove('flash-gray'); btn.offsetWidth; btn.classList.add('flash-gray');
      }
      save();
    }

    function pvp(){
      let enemyStr = Math.floor(Math.random()*5)+1;
      let result;
      let pvpRes = document.getElementById('pvpResult');
      if(strength>=enemyStr){ 
        result = "You won!"; prey+=15; pvpWins++; updateQuests('pvp'); 
        pvpRes.classList.remove('shake','flash-green'); pvpRes.offsetWidth; pvpRes.classList.add('shake','flash-green');
        playSound('sfxWin');
      }
      else { 
        result = "You lost."; 
        pvpRes.classList.remove('flash-red'); pvpRes.offsetWidth; pvpRes.classList.add('flash-red');
        playSound('sfxLose');
      }
      pvpRes.textContent = `Enemy STR ${enemyStr}. ${result}`;
      save();
    }

    function buyItem(item,cost){
      if(prey>=cost){ prey-=cost; inventory.push(item); document.getElementById('shopResult').textContent=`Bought ${item}`; }
      else document.getElementById('shopResult').textContent="Not enough $PREY.";
      save();
    }

    function renderInventory(){
      const list = document.getElementById('inventoryList');
      list.innerHTML="";
      inventory.forEach(i=>{ let li=document.createElement('li'); li.textContent=i; list.appendChild(li); });
    }

    function renderQuests(){
      const list = document.getElementById('questList');
      list.innerHTML="";
      quests.forEach(q=>{
        let li=document.createElement('li');
        li.textContent = `${q.text} [${q.progress}/${q.goal}] Reward:${q.reward}`;
        if(q.completed) li.classList.add('quest','completed');
        list.appendChild(li);
      });
    }

    function updateQuests(type){
      quests.forEach(q=>{
        if(!q.completed){
          if(type==='hunt' && q.text.includes('Hunt')) q.progress++;
          if(type==='pvp' && q.text.includes('PvP')) q.progress++;
          if(q.progress>=q.goal){
            q.completed=true;
            if(typeof q.reward==='number'){ prey+=q.reward; }
            else { inventory.push(q.reward); }
          }
        }
      });
      renderQuests();
      save();
    }

    function renderCodex(){
      const div=document.getElementById('codexEntries');
      div.innerHTML="";
      codex.forEach(c=>{
        if(level>=c.level){ let p=document.createElement('p'); p.textContent=c.text; div.appendChild(p);} });
    }

    function checkLevelUp(){
      while(xp>=level*100){ xp-=level*100; level++; }
    }

    function renderLeaderboard(){
      const list=document.getElementById('leaderboardList');
      list.innerHTML="";
      let player={name:'You', prey, strength, level};
      leaderboard.push(player);
      leaderboard.sort((a,b)=>b.prey-a.prey);
      leaderboard.slice(0,10).forEach(p=>{ let li=document.createElement('li'); li.textContent=`${p.name}: ${p.prey} $PREY (L${p.level} STR${p.strength})`; list.appendChild(li); });
      save();
    }
  </script>
</body>
</html>
