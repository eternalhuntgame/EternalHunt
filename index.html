<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Monetag Ads -->
  <script src="https://a.monetag.com/9855091.js" data-cfasync="false"></script>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Eternal Hunt Game</title>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/10.12.4/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.4/firebase-firestore-compat.js"></script>

  <!-- Monetag Ads -->
  <script src="https://www.monetagtag.com/tag.js" data-zone="9855091" async></script>

  <style>
    body {
      background: radial-gradient(circle, #0a0a0a, #1a1a1a);
      font-family: 'Cinzel', serif;
      color: #f5f5f5;
      margin: 0; padding: 0;
      display: flex; flex-direction: column; align-items: center;
    }
    h1 { text-shadow: 0 0 15px red; }
    .panel {
      background: rgba(20,20,20,0.9);
      border: 2px solid #444;
      border-radius: 12px;
      padding: 15px;
      margin: 10px;
      width: 90%;
      max-width: 500px;
      box-shadow: 0 0 10px #000;
    }
    button {
      background: linear-gradient(to right, #222, #444);
      border: 1px solid #666;
      color: white;
      padding: 10px 15px;
      margin: 5px;
      border-radius: 8px;
      cursor: pointer;
      transition: 0.2s;
    }
    button:hover { transform: scale(1.05); background: #550000; }
    .hidden { display: none; }
    .log { min-height: 60px; margin-top: 10px; }
  </style>
</head>
<body>
  <h1>🐺 Eternal Hunt 🏹</h1>

  <!-- Profile Setup -->
  <div id="profilePanel" class="panel">
    <h2>Profile</h2>
    <input id="usernameInput" placeholder="Enter Discord Username"><br>
    <select id="roleSelect">
      <option value="wolf">🐺 Wolf</option>
      <option value="hunter">🏹 Hunter</option>
    </select><br>
    <button onclick="saveProfile()">Save Profile</button>
  </div>

  <!-- Game UI -->
  <div id="gamePanel" class="hidden">
    <div class="panel">
      <h2>Actions</h2>
      <button onclick="hunt()">🐾 Hunt</button>
      <button onclick="train()">⚔️ Train</button>
      <button onclick="pvp()">🩸 PvP</button>
      <button onclick="showRewardedAd()">📺 Watch Ad</button>
      <div id="mainLog" class="log">Welcome to Eternal Hunt...</div>
    </div>

    <div class="panel">
      <h2>Stats</h2>
      <p id="stats"></p>
    </div>

    <div class="panel">
      <h2>Quests</h2>
      <ul id="questList"></ul>
    </div>

    <div class="panel">
      <h2>Codex</h2>
      <ul id="codexList"></ul>
    </div>

    <div class="panel">
      <h2>Relic Shop</h2>
      <button onclick="buyRelic('Fang of the Alpha', 100)">Fang of the Alpha - 100 $PREY</button>
      <button onclick="buyRelic('Moonlit Talisman', 200)">Moonlit Talisman - 200 $PREY</button>
      <div id="inventory"></div>
    </div>

    <div class="panel">
      <h2>Leaderboard</h2>
      <ol id="leaderboard"></ol>
    </div>
  </div>

<script>
  // --- Firebase Setup ---
  const firebaseConfig = {
    apiKey: "AIzaSyBz11XDhnqNwMyNUjqFpoC8lppEgCP-mew",
    authDomain: "eternal-hunt-game-e48fb.firebaseapp.com",
    projectId: "eternal-hunt-game-e48fb",
    storageBucket: "eternal-hunt-game-e48fb.appspot.com",
    messagingSenderId: "87971567607",
    appId: "1:87971567607:web:2b4401b8e8672436ea80f2"
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();
</script>
<script>
  let player = {
    username: "",
    role: "",
    prey: 0,
    strength: 1,
    relics: [],
    huntsToday: 0,
    lastHuntDate: "",
  };

  const dailyHuntLimit = 5;

  // --- Utility ---
  function todayStr() {
    return new Date().toISOString().split("T")[0];
  }

  function updateStats() {
    document.getElementById("stats").innerText =
      `User: ${player.username}\n` +
      `Role: ${player.role}\n` +
      `Strength: ${player.strength}\n` +
      `$PREY: ${player.prey}\n` +
      `Relics: ${player.relics.join(", ") || "None"}\n` +
      `Hunts Today: ${player.huntsToday}/${dailyHuntLimit}`;
  }

  function logMessage(msg) {
    document.getElementById("mainLog").innerText = msg;
  }

  // --- Profile ---
  async function saveProfile() {
    const username = document.getElementById("usernameInput").value.trim();
    const role = document.getElementById("roleSelect").value;

    if (!username) {
      alert("Please enter a username");
      return;
    }

    player.username = username;
    player.role = role;

    // Save to Firestore
    await db.collection("players").doc(username).set(player, { merge: true });

    document.getElementById("profilePanel").classList.add("hidden");
    document.getElementById("gamePanel").classList.remove("hidden");

    loadQuests();
    loadCodex();
    updateStats();
    loadLeaderboard();
  }

  // --- Hunt ---
  async function hunt() {
    if (player.lastHuntDate !== todayStr()) {
      player.huntsToday = 0;
      player.lastHuntDate = todayStr();
    }

    if (player.huntsToday >= dailyHuntLimit) {
      logMessage("⚠️ You reached the daily hunt limit!");
      return;
    }

    const gain = Math.floor(Math.random() * 20) + 5;
    player.prey += gain;
    player.huntsToday++;
    logMessage(`You hunted and earned ${gain} $PREY! 🐾`);

    await savePlayer();
    updateStats();
    loadLeaderboard();
  }

  // --- Train ---
  async function train() {
    player.strength++;
    logMessage("You trained and grew stronger! ⚔️");
    await savePlayer();
    updateStats();
  }

  // --- PvP ---
  function pvp() {
    logMessage("PvP coming soon... 🩸");
  }

  // --- Shop ---
  async function buyRelic(name, cost) {
    if (player.prey < cost) {
      logMessage("Not enough $PREY!");
      return;
    }
    player.prey -= cost;
    player.relics.push(name);
    logMessage(`You bought ${name}!`);
    await savePlayer();
    updateStats();
    document.getElementById("inventory").innerText =
      "Inventory: " + player.relics.join(", ");
  }

  // --- Firestore Save ---
  async function savePlayer() {
    await db.collection("players").doc(player.username).set(player, { merge: true });
  }

  // --- Leaderboard ---
  async function loadLeaderboard() {
    const snapshot = await db.collection("players").orderBy("prey", "desc").limit(10).get();
    const lb = document.getElementById("leaderboard");
    lb.innerHTML = "";
    snapshot.forEach(doc => {
      const p = doc.data();
      const li = document.createElement("li");
      li.innerText = `${p.username} (${p.role}) - ${p.prey} $PREY`;
      lb.appendChild(li);
    });
  }

  // --- Quests ---
  function loadQuests() {
    const wolfQuests = [
      "Track a lone stag in the mist.",
      "Howl under the blood moon.",
      "Guard the den from intruders.",
      "Chase prey through the snow.",
      "Battle a rival wolf pack.",
      "Protect the Alpha’s legacy.",
      "Scout the hunting grounds.",
      "Test fangs on stone effigy.",
      "Run with the night wind.",
      "Defy the silent hunters."
    ];
    const hunterQuests = [
      "Sharpen arrows under starlight.",
      "Scout wolf tracks in forest.",
      "Protect village from the hunt.",
      "Challenge a rival hunter.",
      "Set traps under moonlight.",
      "Recover relic from ruins.",
      "Test bow against shadows.",
      "Guard the sacred fire.",
      "Hunt the beast of legend.",
      "Record lore in codex."
    ];

    const qList = document.getElementById("questList");
    qList.innerHTML = "";
    const quests = player.role === "wolf" ? wolfQuests : hunterQuests;
    quests.forEach(q => {
      const li = document.createElement("li");
      li.innerText = q;
      qList.appendChild(li);
    });
  }

  // --- Codex ---
  function loadCodex() {
    const wolfCodex = [
      "The Moon guides every hunt.",
      "Wolves thrive in eternal night.",
      "The Alpha’s blood runs eternal.",
      "Fangs carry forgotten power.",
      "Only the pack survives."
    ];
    const hunterCodex = [
      "Hunters protect the balance.",
      "Arrows fly under oath of dawn.",
      "The hunt must never consume.",
      "Relics guide humanity’s path.",
      "Legends live in fire and ink."
    ];

    const cList = document.getElementById("codexList");
    cList.innerHTML = "";
    const codex = player.role === "wolf" ? wolfCodex : hunterCodex;
    codex.forEach(e => {
      const li = document.createElement("li");
      li.innerText = e;
      cList.appendChild(li);
    });
  }

  // --- Ads ---
  function showRewardedAd() {
  logMessage("🎬 Loading rewarded ad...");

  // Call Monetag ad
  if (typeof invokeAd === "function") {
    invokeAd();

    // Simulate reward callback (you must confirm exact callback in Monetag docs)
    document.addEventListener("monetagAdComplete", async () => {
      player.prey += 50;
      await savePlayer();
      updateStats();
      loadLeaderboard();
      logMessage("✅ You earned +50 $PREY for watching an ad!");
    });
  } else {
    logMessage("⚠️ Ad service not available right now.");
  }
 }
</script>
</body>
</html>
